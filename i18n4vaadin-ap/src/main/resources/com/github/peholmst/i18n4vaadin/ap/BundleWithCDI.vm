package ${packageName};

import com.github.peholmst.i18n4vaadin.I18N;
import com.github.peholmst.i18n4vaadin.LocaleChangedEvent;
import java.text.MessageFormat;
import java.util.Locale;
import java.util.ResourceBundle;
import javax.annotation.Generated;
import javax.enterprise.context.SessionScoped;
import javax.enterprise.event.Observes;
import javax.enterprise.event.Reception;
import javax.inject.Inject;

/**
 * Please note that this class is not thread safe! Invocations from multiple
 * threads must be synchronized!
 */
@Generated(value = "${generator}", date = "${generationDate}")
@SessionScoped
public class Bundle implements java.io.Serializable {

    private transient ResourceBundle bundle;

    @Inject
    @SessionScoped
    I18N i18n;

    private Locale getLocale() {
        return i18n.getLocale();
    }

    void localeChanged(@Observes(notifyObserver = Reception.IF_EXISTS) LocaleChangedEvent event) {
        bundle = null;
    }

    ResourceBundle getBundle() {
        if (bundle == null) {
            bundle = ResourceBundle.getBundle("${packageName}.messages", getLocale());
        }
        return bundle;
    }

#foreach ($property in $properties)
    public String $property.replace('.','_')(Object... args) {
        return getMessage("$property", args);
    }
#end

    public static final class Keys {

        private Keys() {
        }
#foreach ($property in $properties)
        public static final String $property.replace('.','_') = "$property";
#end
    }

    public String getMessage(String key, Object... args) {
        final MessageFormat mf = new MessageFormat(getBundle().getString(key), getLocale());
        return mf.format(args, new StringBuffer(), null).toString();
    }
}
